{"ast":null,"code":"import _objectSpread from \"D:/hospital-master2/hospital-web/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport _regeneratorRuntime from \"D:/hospital-master2/hospital-web/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"D:/hospital-master2/hospital-web/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.date.now.js\";\nimport \"core-js/modules/es.number.constructor.js\";\nexport default {\n  name: 'Appointment',\n  props: {\n    id: {\n      type: Number,\n      required: true\n    }\n  },\n  data: function data() {\n    return {\n      doctorName: '',\n      form: {\n        patientName: '',\n        gender: 1,\n        age: 18,\n        phone: '',\n        appointmentDate: '',\n        timeSlot: '',\n        visitType: 1,\n        description: ''\n      },\n      rules: {\n        patientName: [{\n          required: true,\n          message: '请输入患者姓名',\n          trigger: 'blur'\n        }, {\n          min: 2,\n          max: 20,\n          message: '长度在 2 到 20 个字符',\n          trigger: 'blur'\n        }],\n        gender: [{\n          required: true,\n          message: '请选择性别',\n          trigger: 'change'\n        }],\n        age: [{\n          required: true,\n          message: '请输入年龄',\n          trigger: 'blur'\n        }],\n        phone: [{\n          required: true,\n          message: '请输入手机号',\n          trigger: 'blur'\n        }, {\n          pattern: /^1[3-9]\\d{9}$/,\n          message: '请输入正确的手机号',\n          trigger: 'blur'\n        }],\n        appointmentDate: [{\n          required: true,\n          message: '请选择预约日期',\n          trigger: 'change'\n        }],\n        timeSlot: [{\n          required: true,\n          message: '请选择时间段',\n          trigger: 'change'\n        }],\n        visitType: [{\n          required: true,\n          message: '请选择就诊类型',\n          trigger: 'change'\n        }],\n        description: [{\n          required: true,\n          message: '请输入症状描述',\n          trigger: 'blur'\n        }, {\n          min: 10,\n          max: 500,\n          message: '长度在 10 到 500 个字符',\n          trigger: 'blur'\n        }]\n      },\n      dateOptions: {\n        disabledDate: function disabledDate(time) {\n          return time.getTime() < Date.now() - 8.64e7;\n        }\n      },\n      submitting: false\n    };\n  },\n  created: function created() {\n    this.getDoctorInfo();\n  },\n  methods: {\n    getDoctorInfo: function getDoctorInfo() {\n      var _this = this;\n      return _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n        var res;\n        return _regeneratorRuntime().wrap(function _callee$(_context) {\n          while (1) switch (_context.prev = _context.next) {\n            case 0:\n              _context.prev = 0;\n              _context.next = 3;\n              return _this.$http.get(\"/api/empinfo/findById\", {\n                params: {\n                  id: _this.id\n                }\n              });\n            case 3:\n              res = _context.sent;\n              if (res.data.code === 200) {\n                _this.doctorName = res.data.data.username;\n              }\n              _context.next = 10;\n              break;\n            case 7:\n              _context.prev = 7;\n              _context.t0 = _context[\"catch\"](0);\n              _this.$message.error('获取医生信息失败');\n            case 10:\n            case \"end\":\n              return _context.stop();\n          }\n        }, _callee, null, [[0, 7]]);\n      }))();\n    },\n    submitForm: function submitForm() {\n      var _this2 = this;\n      return _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2() {\n        var appointmentData, res;\n        return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n          while (1) switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.prev = 0;\n              _context2.next = 3;\n              return _this2.$refs.form.validate();\n            case 3:\n              _this2.submitting = true;\n              appointmentData = _objectSpread(_objectSpread({}, _this2.form), {}, {\n                doctorId: _this2.id,\n                userId: _this2.$store.state.user.id\n              });\n              _context2.next = 7;\n              return _this2.$http.post('/api/appointment/add', appointmentData);\n            case 7:\n              res = _context2.sent;\n              if (res.data.code === 200) {\n                _this2.$message.success('预约成功');\n                _this2.$router.push('/records');\n              } else {\n                _this2.$message.error(res.data.message || '预约失败');\n              }\n              _context2.next = 14;\n              break;\n            case 11:\n              _context2.prev = 11;\n              _context2.t0 = _context2[\"catch\"](0);\n              if (_context2.t0 !== 'cancel') {\n                _this2.$message.error('预约失败，请重试');\n              }\n            case 14:\n              _context2.prev = 14;\n              _this2.submitting = false;\n              return _context2.finish(14);\n            case 17:\n            case \"end\":\n              return _context2.stop();\n          }\n        }, _callee2, null, [[0, 11, 14, 17]]);\n      }))();\n    },\n    resetForm: function resetForm() {\n      this.$refs.form.resetFields();\n    }\n  }\n};","map":{"version":3,"names":["name","props","id","type","Number","required","data","doctorName","form","patientName","gender","age","phone","appointmentDate","timeSlot","visitType","description","rules","message","trigger","min","max","pattern","dateOptions","disabledDate","time","getTime","Date","now","submitting","created","getDoctorInfo","methods","_this","_asyncToGenerator","_regeneratorRuntime","mark","_callee","res","wrap","_callee$","_context","prev","next","$http","get","params","sent","code","username","t0","$message","error","stop","submitForm","_this2","_callee2","appointmentData","_callee2$","_context2","$refs","validate","_objectSpread","doctorId","userId","$store","state","user","post","success","$router","push","finish","resetForm","resetFields"],"sources":["src/views/Appointment.vue"],"sourcesContent":["<template>\r\n  <div class=\"appointment-page page-container\">\r\n    <div class=\"page-header\">\r\n      <el-page-header @back=\"$router.go(-1)\" :content=\"'预约挂号 - ' + doctorName\"></el-page-header>\r\n    </div>\r\n    \r\n    <el-card class=\"appointment-card\" shadow=\"hover\">\r\n      <el-form ref=\"form\" :model=\"form\" :rules=\"rules\" label-width=\"100px\" class=\"appointment-form\">\r\n        <div class=\"form-section\">\r\n          <h3 class=\"section-title\">患者信息</h3>\r\n          <el-form-item label=\"姓名\" prop=\"patientName\">\r\n            <el-input v-model=\"form.patientName\" placeholder=\"请输入患者姓名\"></el-input>\r\n          </el-form-item>\r\n          <el-form-item label=\"性别\" prop=\"gender\">\r\n            <el-radio-group v-model=\"form.gender\">\r\n              <el-radio :label=\"1\">男</el-radio>\r\n              <el-radio :label=\"2\">女</el-radio>\r\n            </el-radio-group>\r\n          </el-form-item>\r\n          <el-form-item label=\"年龄\" prop=\"age\">\r\n            <el-input-number v-model=\"form.age\" :min=\"1\" :max=\"150\"></el-input-number>\r\n          </el-form-item>\r\n          <el-form-item label=\"手机号\" prop=\"phone\">\r\n            <el-input v-model=\"form.phone\" placeholder=\"请输入联系电话\"></el-input>\r\n          </el-form-item>\r\n        </div>\r\n\r\n        <div class=\"form-section\">\r\n          <h3 class=\"section-title\">预约信息</h3>\r\n          <el-form-item label=\"预约日期\" prop=\"appointmentDate\">\r\n            <el-date-picker\r\n              v-model=\"form.appointmentDate\"\r\n              type=\"date\"\r\n              placeholder=\"选择日期\"\r\n              :picker-options=\"dateOptions\">\r\n            </el-date-picker>\r\n          </el-form-item>\r\n          <el-form-item label=\"时间段\" prop=\"timeSlot\">\r\n            <el-select v-model=\"form.timeSlot\" placeholder=\"请选择时间段\">\r\n              <el-option label=\"上午\" :value=\"1\"></el-option>\r\n              <el-option label=\"下午\" :value=\"2\"></el-option>\r\n            </el-select>\r\n          </el-form-item>\r\n          <el-form-item label=\"就诊类型\" prop=\"visitType\">\r\n            <el-select v-model=\"form.visitType\" placeholder=\"请选择就诊类型\">\r\n              <el-option label=\"初诊\" :value=\"1\"></el-option>\r\n              <el-option label=\"复诊\" :value=\"2\"></el-option>\r\n            </el-select>\r\n          </el-form-item>\r\n          <el-form-item label=\"症状描述\" prop=\"description\">\r\n            <el-input\r\n              type=\"textarea\"\r\n              v-model=\"form.description\"\r\n              :rows=\"4\"\r\n              placeholder=\"请简要描述症状...\">\r\n            </el-input>\r\n          </el-form-item>\r\n        </div>\r\n\r\n        <el-form-item class=\"form-actions\">\r\n          <el-button type=\"primary\" @click=\"submitForm\" :loading=\"submitting\">\r\n            确认预约\r\n          </el-button>\r\n          <el-button @click=\"resetForm\">重置</el-button>\r\n        </el-form-item>\r\n      </el-form>\r\n    </el-card>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  name: 'Appointment',\r\n  props: {\r\n    id: {\r\n      type: Number,\r\n      required: true\r\n    }\r\n  },\r\n  data() {\r\n    return {\r\n      doctorName: '',\r\n      form: {\r\n        patientName: '',\r\n        gender: 1,\r\n        age: 18,\r\n        phone: '',\r\n        appointmentDate: '',\r\n        timeSlot: '',\r\n        visitType: 1,\r\n        description: ''\r\n      },\r\n      rules: {\r\n        patientName: [\r\n          { required: true, message: '请输入患者姓名', trigger: 'blur' },\r\n          { min: 2, max: 20, message: '长度在 2 到 20 个字符', trigger: 'blur' }\r\n        ],\r\n        gender: [\r\n          { required: true, message: '请选择性别', trigger: 'change' }\r\n        ],\r\n        age: [\r\n          { required: true, message: '请输入年龄', trigger: 'blur' }\r\n        ],\r\n        phone: [\r\n          { required: true, message: '请输入手机号', trigger: 'blur' },\r\n          { pattern: /^1[3-9]\\d{9}$/, message: '请输入正确的手机号', trigger: 'blur' }\r\n        ],\r\n        appointmentDate: [\r\n          { required: true, message: '请选择预约日期', trigger: 'change' }\r\n        ],\r\n        timeSlot: [\r\n          { required: true, message: '请选择时间段', trigger: 'change' }\r\n        ],\r\n        visitType: [\r\n          { required: true, message: '请选择就诊类型', trigger: 'change' }\r\n        ],\r\n        description: [\r\n          { required: true, message: '请输入症状描述', trigger: 'blur' },\r\n          { min: 10, max: 500, message: '长度在 10 到 500 个字符', trigger: 'blur' }\r\n        ]\r\n      },\r\n      dateOptions: {\r\n        disabledDate(time) {\r\n          return time.getTime() < Date.now() - 8.64e7\r\n        }\r\n      },\r\n      submitting: false\r\n    }\r\n  },\r\n  created() {\r\n    this.getDoctorInfo()\r\n  },\r\n  methods: {\r\n    async getDoctorInfo() {\r\n      try {\r\n        const res = await this.$http.get(`/api/empinfo/findById`, {\r\n          params: { id: this.id }\r\n        })\r\n        if (res.data.code === 200) {\r\n          this.doctorName = res.data.data.username\r\n        }\r\n      } catch (error) {\r\n        this.$message.error('获取医生信息失败')\r\n      }\r\n    },\r\n    async submitForm() {\r\n      try {\r\n        await this.$refs.form.validate()\r\n        this.submitting = true\r\n        \r\n        const appointmentData = {\r\n          ...this.form,\r\n          doctorId: this.id,\r\n          userId: this.$store.state.user.id\r\n        }\r\n        \r\n        const res = await this.$http.post('/api/appointment/add', appointmentData)\r\n        if (res.data.code === 200) {\r\n          this.$message.success('预约成功')\r\n          this.$router.push('/records')\r\n        } else {\r\n          this.$message.error(res.data.message || '预约失败')\r\n        }\r\n      } catch (error) {\r\n        if (error !== 'cancel') {\r\n          this.$message.error('预约失败，请重试')\r\n        }\r\n      } finally {\r\n        this.submitting = false\r\n      }\r\n    },\r\n    resetForm() {\r\n      this.$refs.form.resetFields()\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.appointment-page {\r\n  .page-header {\r\n    margin-bottom: 30px;\r\n    \r\n    :deep(.el-page-header) {\r\n      .el-page-header__left {\r\n        .el-icon-back {\r\n          font-size: 18px;\r\n          color: #409EFF;\r\n        }\r\n        \r\n        .el-page-header__title {\r\n          font-size: 14px;\r\n          color: #606266;\r\n        }\r\n      }\r\n      \r\n      .el-page-header__content {\r\n        font-size: 20px;\r\n        font-weight: 500;\r\n        color: #303133;\r\n      }\r\n    }\r\n  }\r\n  \r\n  .appointment-card {\r\n    background: rgba(255, 255, 255, 0.9);\r\n    border: none;\r\n    border-radius: 8px;\r\n    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);\r\n    transition: all 0.3s ease;\r\n    \r\n    &:hover {\r\n      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);\r\n    }\r\n    \r\n    .appointment-form {\r\n      padding: 20px;\r\n      \r\n      .form-section {\r\n        margin-bottom: 30px;\r\n        \r\n        .section-title {\r\n          font-size: 18px;\r\n          font-weight: 500;\r\n          color: #303133;\r\n          margin: 0 0 20px;\r\n          padding-bottom: 10px;\r\n          border-bottom: 2px solid #ebeef5;\r\n        }\r\n      }\r\n      \r\n      :deep(.el-form-item) {\r\n        margin-bottom: 22px;\r\n        \r\n        .el-form-item__label {\r\n          font-weight: 500;\r\n          color: #606266;\r\n        }\r\n        \r\n        .el-input,\r\n        .el-select,\r\n        .el-date-editor {\r\n          width: 100%;\r\n          max-width: 360px;\r\n        }\r\n        \r\n        .el-input-number {\r\n          width: 180px;\r\n        }\r\n        \r\n        .el-radio-group {\r\n          .el-radio {\r\n            margin-right: 30px;\r\n            \r\n            &:last-child {\r\n              margin-right: 0;\r\n            }\r\n          }\r\n        }\r\n        \r\n        .el-textarea {\r\n          width: 100%;\r\n          max-width: 100%;\r\n          \r\n          .el-textarea__inner {\r\n            padding: 10px;\r\n            min-height: 120px;\r\n          }\r\n        }\r\n      }\r\n      \r\n      .form-actions {\r\n        margin-top: 40px;\r\n        margin-bottom: 0;\r\n        text-align: center;\r\n        \r\n        .el-button {\r\n          width: 180px;\r\n          height: 40px;\r\n          margin: 0 10px;\r\n          border-radius: 20px;\r\n          font-size: 16px;\r\n          \r\n          &--primary {\r\n            background: linear-gradient(90deg, #409EFF 0%, #66b1ff 100%);\r\n            border: none;\r\n            \r\n            &:hover {\r\n              background: linear-gradient(90deg, #66b1ff 0%, #409EFF 100%);\r\n              transform: translateY(-2px);\r\n              box-shadow: 0 4px 12px rgba(64, 158, 255, 0.3);\r\n            }\r\n          }\r\n          \r\n          &:not(.el-button--primary) {\r\n            border: 1px solid #dcdfe6;\r\n            \r\n            &:hover {\r\n              border-color: #c6e2ff;\r\n              color: #409EFF;\r\n              background: #ecf5ff;\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n</style>\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}