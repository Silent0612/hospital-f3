"use strict";(self["webpackChunkhospital_web"]=self["webpackChunkhospital_web"]||[]).push([[104],{4104:(e,r,s)=>{s.r(r),s.d(r,{default:()=>u});var t=function(){var e=this,r=e._self._c;return r("div",{staticClass:"login-container"},[r("el-card",{staticClass:"login-card"},[r("div",{staticClass:"title"},[e._v("医院预约挂号系统")]),r("el-form",{ref:"loginForm",attrs:{model:e.form,rules:e.rules,"label-width":"0"}},[r("el-form-item",{attrs:{prop:"phone"}},[r("el-input",{attrs:{"prefix-icon":"el-icon-user",placeholder:"请输入手机号"},model:{value:e.form.phone,callback:function(r){e.$set(e.form,"phone",r)},expression:"form.phone"}})],1),r("el-form-item",{attrs:{prop:"password"}},[r("el-input",{attrs:{type:"password","prefix-icon":"el-icon-lock",placeholder:"请输入密码","show-password":""},model:{value:e.form.password,callback:function(r){e.$set(e.form,"password",r)},expression:"form.password"}})],1),r("el-form-item",[r("el-button",{staticClass:"login-button",attrs:{type:"primary"},on:{click:e.handleLogin}},[e._v("登录")])],1)],1),r("div",{staticClass:"register-link"},[e._v(" 还没有账号？"),r("router-link",{attrs:{to:"/register"}},[e._v("立即注册")])],1)],1)],1)},o=[],a=s(4048),n=s(388);s(4114),s(739),s(3110);const l={data:function(){return{form:{phone:"",password:""},rules:{phone:[{required:!0,message:"请输入手机号",trigger:"blur"},{pattern:/^1[3-9]\d{9}$/,message:"请输入正确的手机号",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,message:"密码长度不能小于6位",trigger:"blur"}]}}},methods:{handleLogin:function(){var e=this;this.$refs.loginForm.validate(function(){var r=(0,n.A)((0,a.A)().mark((function r(s){var t,o,n,l;return(0,a.A)().wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(!s){r.next=15;break}return r.prev=1,console.log("发送登录请求:",e.form),r.next=5,e.$http.post("/api/patient/login",{phone:e.form.phone,password:e.form.password});case 5:t=r.sent,console.log("登录响应:",t),o=t.data,200===o.code?(n=o.data,2===n.roleid?(localStorage.setItem("userInfo",JSON.stringify(n)),localStorage.setItem("isLogin","true"),localStorage.setItem("token",n.id),e.$message.success("登录成功"),e.$router.push("/home/departments")):e.$message.error("非病人用户不能登录")):e.$message.error(o.message||"登录失败"),r.next=15;break;case 11:r.prev=11,r.t0=r["catch"](1),console.error("登录错误:",r.t0),r.t0.response?e.$message.error((null===(l=r.t0.response.data)||void 0===l?void 0:l.message)||"登录失败，请检查用户名和密码"):e.$message.error("登录失败，请稍后重试");case 15:case"end":return r.stop()}}),r,null,[[1,11]])})));return function(e){return r.apply(this,arguments)}}())}}},i=l;var c=s(1656),p=(0,c.A)(i,t,o,!1,null,"6cbc288c",null);const u=p.exports}}]);
//# sourceMappingURL=104.0caea2ee.js.map